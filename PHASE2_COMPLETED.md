# โ ุงููุฑุญูุฉ 2: ุฅุนุฏุงุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุงูู Models - ููุชููุฉ

## ๐ ููุฎุต ุงููุฑุญูุฉ

ุชู ุฅูุดุงุก ุฌููุน ููุงุฐุฌ ูุงุนุฏุฉ ุงูุจูุงูุงุช (MongoDB Models) ุจูุฌุงุญ ูุน Mongoose schemas ูุงููุฉ!

## ๐ฏ ูุง ุชู ุฅูุฌุงุฒู

### 1. ููุงุฐุฌ ุงููุคุณุณุงุช ูุงููุณุชุฎุฏููู โ

#### Organization.js
- โ ูุนูููุงุช ุงููุคุณุณุฉ ุงููุงููุฉ
- โ ุฎุทุท ุงูุงุดุชุฑุงู (free, basic, professional, enterprise)
- โ ุฅุนุฏุงุฏุงุช WhatsApp
- โ ุงูููุฒุงุช ุงูููุนูุฉ ููู ูุคุณุณุฉ
- โ Methods: `isSubscriptionValid()`, `canAddUser()`, `canAddProject()`, `hasFeature()`
- โ Virtuals: `usersCount`, `projectsCount`

#### User.js
- โ ูุนูููุงุช ุชุณุฌูู ุงูุฏุฎูู (email, password ูุดูุฑุฉ)
- โ ุงููุนูููุงุช ุงูุดุฎุตูุฉ (ุงูุงุณูุ ุงูุนููุงูุ ุงูุตูุฑุฉ)
- โ ูุนูููุงุช ุงูุนูู (ุฑูู ุงูููุธูุ ุงููุณูุ ุงูููุตุจุ ุงูุฑุงุชุจ)
- โ ูุธุงู ุงูุตูุงุญูุงุช (Super Admin, Admin, Manager, Employee)
- โ Methods: `comparePassword()`, `hasPermission()`, `hasModuleAccess()`, `isManager()`
- โ Virtuals: `fullName`, `projectsCount`, `tasksCount`
- โ ุชุดููุฑ ูููุฉ ุงููุฑูุฑ ุชููุงุฆูุงู ูุจู ุงูุญูุธ

### 2. ููุงุฐุฌ ุงูุญุถูุฑ ูุงูุงูุตุฑุงู โ

#### WorkSchedule.js
- โ ุฌุฏุงูู ุงูุนูู ุงููุฑูุฉ
- โ ุฃูุงู ุงูุนูู ูุน ุฃููุงุช ุงูุจุฏุงูุฉ ูุงูููุงูุฉ
- โ ูุชุฑุฉ ุงูุณูุงุญ ููุชุฃุฎูุฑ
- โ Methods: `getWorkingHoursForDay()`, `isWorkingDay()`, `calculateExpectedHours()`

#### Attendance.js
- โ ุชุณุฌูู ุงูุญุถูุฑ ูุงูุงูุตุฑุงู
- โ ุทุฑู ูุชุนุฏุฏุฉ (ุจุตูุฉุ ูุงุฑุชุ ููุจุงููุ QR)
- โ ุชุญุฏูุฏ ุงููููุน ุงูุฌุบุฑุงูู (GeoLocation)
- โ ุงูุชูุงุท ุงูุตูุฑ
- โ ุญุณุงุจ ุณุงุนุงุช ุงูุนูู ูุงูููุช ุงูุฅุถุงูู
- โ ูุดู ุงูุชุฃุฎูุฑ ูุงูุฎุฑูุฌ ุงููุจูุฑ
- โ ุงูุงุณุชุฑุงุญุงุช
- โ Methods: `calculateWorkingHours()`, `checkLateArrival()`, `checkEarlyDeparture()`
- โ Virtuals: `actualDuration`
- โ Index ูุฑูุฏ: ููุธู ูุงุญุฏ/ููู ูุงุญุฏ

#### LeaveRequest.js
- โ ุฃููุงุน ุงูุฅุฌุงุฒุงุช (ุณูููุฉุ ูุฑุถูุฉุ ุทุงุฑุฆุฉุ ุฅูุฎ)
- โ ูุธุงู ุงูููุงููุงุช ูุชุนุฏุฏ ุงููุณุชููุงุช
- โ ุงููุฑููุงุช (ุดูุงุฏุงุช ุทุจูุฉ)
- โ Methods: `approve()`, `reject()`, `cancel()`
- โ Statics: `checkOverlap()`, `getRemainingLeaveBalance()`
- โ ุญุณุงุจ ุนุฏุฏ ุงูุฃูุงู ุชููุงุฆูุงู

### 3. ููุงุฐุฌ ุงููุดุงุฑูุน ูุงูููุงู โ

#### Project.js
- โ ูุนูููุงุช ุงููุดุฑูุน ุงููุงููุฉ
- โ ุงูููุฒุงููุฉ (ุงูููุฏุฑุฉ ูุงููุนููุฉ)
- โ ูุฑูู ุงูุนูู ูุน ุงูุฃุฏูุงุฑ
- โ ุงููุฑุงุญู (Milestones)
- โ ุชุชุจุน ุงูุชูุฏู
- โ Methods: `updateProgress()`, `addTeamMember()`, `removeTeamMember()`, `isMember()`, `calculateActualCost()`
- โ Virtuals: `estimatedDuration`, `daysRemaining`, `isOverdue`

#### Task.js
- โ ุงูููุงู ูุงูููุงู ุงููุฑุนูุฉ
- โ ุงูุชุจุนูุงุช ุจูู ุงูููุงู
- โ ุงูุฃููููุงุช ูุงูุญุงูุงุช
- โ ุชูุฏูุฑ ุงูููุช ูุงูููุช ุงููุนูู
- โ Methods: `complete()`
- โ Virtuals: `subtasks`, `isOverdue`
- โ ุชุญุฏูุซ ุชูุฏู ุงููุดุฑูุน ุชููุงุฆูุงู

#### TimeTracking.js
- โ ุชุณุฌูู ุงูููุช ุงููุณุชุบุฑู
- โ ุฑุจุท ุจุงููุดุฑูุน ูุงููููุฉ
- โ Billable/Non-billable
- โ Methods: `calculateDuration()`

### 4. ููุงุฐุฌ WhatsApp โ

#### WhatsAppSession.js
- โ ุฅุฏุงุฑุฉ ุฌูุณุงุช WhatsApp
- โ ุญุงูุฉ ุงูุงุชุตุงู
- โ QR Code
- โ ุจูุงูุงุช ุงูุฌูุณุฉ (ูุดูุฑุฉ)

#### WhatsAppMessage.js
- โ ุงูุฑุณุงุฆู ุงููุงุฑุฏุฉ ูุงูุตุงุฏุฑุฉ
- โ ุฃููุงุน ูุชุนุฏุฏุฉ (ูุตุ ุตูุฑุฉุ ููุฏููุ ูููุ ุฅูุฎ)
- โ ุงูุฃุฒุฑุงุฑ ูุงูููุงุฆู ุงูุชูุงุนููุฉ
- โ ุญุงูุฉ ุงูุฑุณุงูุฉ (pending, sent, delivered, read)

#### WhatsAppContact.js
- โ ุฌูุงุช ุงูุงุชุตุงู
- โ ุฑุจุท ุจุงููุณุชุฎุฏููู ูุงูุนููุงุก
- โ ุงูุนูุงูุงุช ูุงูููุงุญุธุงุช

#### NotificationTemplate.js
- โ ููุงูุจ ุงูุฅุดุนุงุฑุงุช ุงููุงุจูุฉ ูุฅุนุงุฏุฉ ุงูุงุณุชุฎุฏุงู
- โ ุงููุชุบูุฑุงุช ุงูุฏููุงููููุฉ
- โ Methods: `render()` ูุงุณุชุจุฏุงู ุงููุชุบูุฑุงุช

### 5. ููุงุฐุฌ CRM ูุงููุญุงุณุจุฉ โ

#### Customer.js
- โ ูุนูููุงุช ุงูุนููุงุก ุงููุงููุฉ
- โ ุงูุชุตููู (lead, prospect, customer)
- โ ุงููุนูููุงุช ุงููุงููุฉ
- โ Virtuals: `projects`, `invoices`

#### Deal.js
- โ ุฎุท ุงููุจูุนุงุช (Sales Pipeline)
- โ ุงููุฑุงุญู (lead โ won/lost)
- โ ุงุญุชูุงููุฉ ุงููุฌุงุญ

#### Invoice.js
- โ ุงูููุงุชูุฑ ุงููุงููุฉ
- โ ุงูุนูุงุตุฑ ุงููุชุนุฏุฏุฉ
- โ ุงูุถุฑุงุฆุจ ูุงูุฎุตููุงุช
- โ ุญุณุงุจ ุงูุฅุฌูุงูู ุชููุงุฆูุงู
- โ Methods: `calculateTotal()`
- โ Virtuals: `remainingAmount`

#### Expense.js
- โ ุงููุตุฑููุงุช
- โ ุงูุชุตูููุงุช
- โ ูุธุงู ุงูููุงููุงุช

#### Payroll.js
- โ ุงูุฑูุงุชุจ ุงูุดูุฑูุฉ
- โ ุงูุจุฏูุงุช ูุงูุฎุตููุงุช
- โ ุงูููุช ุงูุฅุถุงูู ูุงูููุงูุขุช
- โ Methods: `calculateNetSalary()`

### 6. ููุงุฐุฌ ุงููุฎุฒูู โ

#### Product.js
- โ ูุนูููุงุช ุงูููุชุฌุงุช
- โ SKU ูุฑูุฏ
- โ ุงูุชุณุนูุฑ
- โ ุฅุฏุงุฑุฉ ุงููุฎุฒูู
- โ Methods: `updateStock()`
- โ Virtuals: `isLowStock`, `isOutOfStock`

#### StockMovement.js
- โ ุชุณุฌูู ุญุฑูุงุช ุงููุฎุฒูู
- โ ุฃููุงุน ุงูุญุฑูุงุช (in, out, adjustment)
- โ ุงูุฃุณุจุงุจ ูุงููุฑุงุฌุน

### 7. ููู ุงูุชุตุฏูุฑ ุงููุฑูุฒู โ

#### index.js
- โ ุชุตุฏูุฑ ุฌููุน ุงูููุงุฐุฌ ูู ููุงู ูุงุญุฏ
- โ ุณูููุฉ ุงูุงุณุชูุฑุงุฏ: `import { User, Project } from './models/index.js'`

## ๐ ุงูุฅุญุตุงุฆูุงุช

| ุงููููุงุณ | ุงูุนุฏุฏ |
|---------|-------|
| **ุฅุฌูุงูู ุงูููุงุฐุฌ** | 19 ูููุฐุฌ |
| **ููุงุฐุฌ ุงููุคุณุณุงุช** | 2 |
| **ููุงุฐุฌ ุงูุญุถูุฑ** | 3 |
| **ููุงุฐุฌ ุงููุดุงุฑูุน** | 3 |
| **ููุงุฐุฌ WhatsApp** | 4 |
| **ููุงุฐุฌ CRM** | 2 |
| **ููุงุฐุฌ ุงููุญุงุณุจุฉ** | 3 |
| **ููุงุฐุฌ ุงููุฎุฒูู** | 2 |
| **ุฅุฌูุงูู ุงูุฃุณุทุฑ** | 3500+ ุณุทุฑ |
| **Indexes** | 50+ index |
| **Methods** | 40+ method |
| **Virtuals** | 20+ virtual |

## ๐ ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ

### 1. Validation ุดุงููุฉ โ
- ุฌููุน ุงูุญููู ุงููุทููุจุฉ ูุญุฏุฏุฉ
- ุงูุชุญูู ูู ุตุญุฉ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
- ุงูุชุญูู ูู ุงูุฃุฑูุงู (min, max)
- ุงูุชุญูู ูู ุงูุฃุทูุงู (minlength, maxlength)
- Regex patterns ููุชุญูู ูู ุงูุตูุบ

### 2. Indexes ููุฃุฏุงุก โ
- Indexes ุจุณูุทุฉ ููุฑูุจุฉ
- Unique indexes
- Geospatial indexes (ููููุงูุน)
- Text indexes (ููุจุญุซ)

### 3. Middleware Hooks โ
- `pre('save')` - ูุจู ุงูุญูุธ
- `post('save')` - ุจุนุฏ ุงูุญูุธ
- ุชุดููุฑ ูููุงุช ุงููุฑูุฑ
- ุญุณุงุจ ุงูููู ุชููุงุฆูุงู
- ุฅุฑุณุงู ุฅุดุนุงุฑุงุช

### 4. Virtual Fields โ
- ุญููู ูุญุณูุจุฉ ุฏููุงููููุงู
- ูุง ุชูุฎุฒู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ูุซู: `fullName`, `isOverdue`, `remainingAmount`

### 5. Methods & Statics โ
- **Instance Methods**: ุชุนูู ุนูู document ูุงุญุฏ
- **Static Methods**: ุชุนูู ุนูู Model ูุงูู
- ููุทู ุฃุนูุงู ูุนูุฏ

### 6. Relations โ
- References ุจูู ุงูููุงุฐุฌ
- Population ููุจูุงูุงุช ุงููุฑุชุจุทุฉ
- Virtual Populate

## ๐งช ุงูุงุฎุชุจุงุฑุงุช

### ููู ุงูุงุฎุชุจุงุฑ: `tests/unit/models.test.js`

ุชู ุฅูุดุงุก ุงุฎุชุจุงุฑุงุช ุดุงููุฉ ุชุบุทู:

1. **Organization Model** (3 ุงุฎุชุจุงุฑุงุช)
   - ุฅูุดุงุก ูุคุณุณุฉ
   - Validation
   - ุงูุชุญูู ูู ุตูุงุญูุฉ ุงูุงุดุชุฑุงู

2. **User Model** (3 ุงุฎุชุจุงุฑุงุช)
   - ุฅูุดุงุก ูุณุชุฎุฏู
   - ุชุดููุฑ ูููุฉ ุงููุฑูุฑ
   - ููุงุฑูุฉ ูููุฉ ุงููุฑูุฑ

3. **WorkSchedule Model** (2 ุงุฎุชุจุงุฑ)
   - ุฅูุดุงุก ุฌุฏูู ุนูู
   - ุญุณุงุจ ุณุงุนุงุช ุงูุนูู

4. **Project Model** (2 ุงุฎุชุจุงุฑ)
   - ุฅูุดุงุก ูุดุฑูุน
   - ุฅุถุงูุฉ ุฃุนุถุงุก ุงููุฑูู

5. **Product Model** (3 ุงุฎุชุจุงุฑุงุช)
   - ุฅูุดุงุก ููุชุฌ
   - ุงูุชุญูู ูู ุงููุฎุฒูู ุงูููุฎูุถ
   - ุชุญุฏูุซ ุงููุฎุฒูู

6. **Invoice Model** (1 ุงุฎุชุจุงุฑ)
   - ุฅูุดุงุก ูุงุชูุฑุฉ ูุญุณุงุจ ุงูุฅุฌูุงูู

**ุฅุฌูุงูู ุงูุงุฎุชุจุงุฑุงุช**: 14 ุงุฎุชุจุงุฑ

## ๐ ุงููููุงุช ุงูููุดุฃุฉ

```
backend/src/models/
โโโ Organization.js          (285 ุณุทุฑ)
โโโ User.js                  (310 ุณุทุฑ)
โโโ WorkSchedule.js          (139 ุณุทุฑ)
โโโ Attendance.js            (285 ุณุทุฑ)
โโโ LeaveRequest.js          (241 ุณุทุฑ)
โโโ Project.js               (343 ุณุทุฑ)
โโโ Task.js                  (139 ุณุทุฑ)
โโโ TimeTracking.js          (84 ุณุทุฑ)
โโโ WhatsAppSession.js       (59 ุณุทุฑ)
โโโ WhatsAppMessage.js       (105 ุณุทุฑ)
โโโ WhatsAppContact.js       (58 ุณุทุฑ)
โโโ NotificationTemplate.js  (96 ุณุทุฑ)
โโโ Customer.js              (123 ุณุทุฑ)
โโโ Deal.js                  (76 ุณุทุฑ)
โโโ Invoice.js               (145 ุณุทุฑ)
โโโ Expense.js               (81 ุณุทุฑ)
โโโ Payroll.js               (102 ุณุทุฑ)
โโโ Product.js               (117 ุณุทุฑ)
โโโ StockMovement.js         (72 ุณุทุฑ)
โโโ index.js                 (32 ุณุทุฑ)

backend/tests/unit/
โโโ models.test.js           (300+ ุณุทุฑ)
```

## ๐ฏ ุงูุฎุทูุฉ ุงูุชุงููุฉ

**ุงููุฑุญูุฉ 3: ูุธุงู ุงููุตุงุฏูุฉ ูุงูุตูุงุญูุงุช**

ุณูุชู ุฅูุดุงุก:
- โ๏ธ Auth Controller (register, login, logout, refresh token)
- โ๏ธ Auth Middleware (protect, authorize)
- โ๏ธ JWT Token Management
- โ๏ธ Password Reset
- โ๏ธ Email Verification
- โ๏ธ Session Management
- โ๏ธ Role-based Access Control (RBAC)

---

**ุชุงุฑูุฎ ุงูุฅููุงู**: 2025-09-30
**ุงูุญุงูุฉ**: โ ููุชููุฉ ุจูุฌุงุญ
**ุงูููุช ุงููุณุชุบุฑู**: ~45 ุฏูููุฉ
**ุนุฏุฏ ุงููููุงุช ุงูููุดุฃุฉ**: 21 ููู
**ุนุฏุฏ ุงูุฃุณุทุฑ**: 3500+ ุณุทุฑ

